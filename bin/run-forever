#!/bin/bash

# Ignore SIGINT and SIGTERM received by the script itself
exit_script() {
    :
}
trap exit_script SIGINT SIGTERM

DELAY=5
while true; do
    $@
    EXIT_CODE=$?

    if [[ "${EXIT_CODE}" -eq 0 || "${EXIT_CODE}" -eq 137 ]]
    then
        exit 0
    fi

    echo "\n\nProcess terminated with an error (exit code ${EXIT_CODE}).\nRespawning it in ${DELAY} seconds...\n\n" >&2
    sleep ${DELAY}
done
